<div class="row">
  <div class="col">
    <div class="upload-wrapper">
      @if (!sessionService.isAuthenticated) {
        <div class="upload-overlay"></div>
      }

      <div
        class="drop-files"
        [class.statements-border]="uploadType === 'statements'"
        [style.background-color]="backgroundColor"
        [class.bg-primary]="!backgroundColor"
        appUpload
        [uploadType]="uploadType"
        [broker]="selectedBroker"
      >
        <div class="text-white">
          @if (showBrokerSelect) {
            <div class="mb-3 row align-items-center justify-content-center">
              <label for="broker-select" class="col-auto col-form-label h5 mb-0">Corretora:</label>
              <div class="col-auto">
                <select
                  id="broker-select"
                  class="form-select"
                  [class.is-invalid]="isInvalid"
                  [(ngModel)]="selectedBroker"
                  (ngModelChange)="onBrokerChange.emit($event)"
                >
                  <option value="">Selecione</option>
                  <option value="Avenue">Avenue</option>
                  <option value="BTG">BTG</option>
                  <option value="CHARLES_SCHWAB">Charles Schwab</option>
                  <option value="XP">XP</option>
                </select>
              </div>
            </div>
          }

          <div
            class="row align-items-center justify-content-center g-3 small-font"
            style="cursor: pointer"
            role="button"
            tabindex="0"
            [attr.aria-label]="ariaLabel"
            (click)="uploadInput.click()"
            (keyup.enter)="uploadInput.click()"
          >
            <div class="col-auto">
              <fa-icon [icon]="fileIcon" size="4x"></fa-icon>
            </div>
            <div class="col-auto">
              <p class="h5 mb-2">Arraste os arquivos ou selecione abaixo:</p>
              <input
                [id]="inputId"
                type="file"
                [name]="inputName"
                class="form-control"
                multiple
                (change)="onFileInput.emit($event)"
                (click)="$event.stopPropagation()"
                #uploadInput
              />
            </div>
          </div>
        </div>

        <div
          id="status-wrapper"
          class="bg-light p-0 border border-secondary rounded mt-3 small-font"
          [class.d-none]="!hasFiles"
        >
          @for (upload of uploads; track upload) {
            <span
              class="badge me-0 m-1"
              [class.bg-secondary]="!upload.responseComplete"
              [class.bg-danger]="upload.serverError"
              [class.bg-success]="upload.responseComplete && !upload.serverError"
            >
              {{ upload.filename }}
              @if (!upload.responseComplete) {
                <img src="../../assets/ajax-loader.gif" alt="Loading" />
              }
            </span>
          }
        </div>
      </div>
    </div>

    @if (hasErrors) {
      <div class="mt-3 p-3 bg-danger bg-gradient-danger small-font">
        <h4 class="text-white">Erros</h4>
        <ul class="list-group list-group-numbered list-group-flush bg-danger-subtle rounded">
          @for (error of errorMessages; track error) {
            <li class="list-group-item list-group-item-danger">
              {{ error }}
            </li>
          }
        </ul>
      </div>
    }
  </div>
</div>
